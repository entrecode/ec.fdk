# ec.fdk

Lightweight SDK for entrecode APIs.
Currently supports only most common PublicAPI functions.

## Install

```sh
npm i ec.fdk
```

## Publish

0. `cd packages/ec.fdk`
1. bump version in `packages/ec.fdk/package.json`
2. run `pnpm readme`
3. commit + push
4. run `pnpm publish`

# API

Start by calling `sdk` with your environment (`stage` | `live`), then method chain your way to success:

```js
import { sdk } from "ec.fdk";

sdk("stage") // choose stage environment
.dm("83cc6374") // select datamanager via short id
.model("muffin") // select model muffin
.entries() // load entry list
.then(list => {
  console.log(list);
})
```

You can also reuse parts of the chain with variables:

```js
// we want to do stuff with model muffin here
const muffin = sdk("stage").dm("83cc6374").model("muffin");
// load entry list
const { items } = await muffin.entries();
// edit first entry
await muffin.editEntry(items[0].id, { name: "edit!" });
// delete second entry
await muffin.deleteEntry(items[1].id);
// create a new muffin
await muffin.createEntry({ name: "new muffin" });
```

Now what follows is the autogenerated doc from source:

<a name="module_api.Sdk"></a>

### api.Sdk
<p>SDK</p>

**Kind**: static class of [<code>api</code>](#module_api)  

* [.Sdk](#module_api.Sdk)
    * [.entries([options])](#module_api.Sdk+entries) ⇒ [<code>Promise.&lt;EntryList&gt;</code>](#EntryList)
    * [.getEntry(entryID)](#module_api.Sdk+getEntry) ⇒ [<code>Promise.&lt;EntryResource&gt;</code>](#EntryResource)
    * [.assets([options])](#module_api.Sdk+assets) ⇒ [<code>Promise.&lt;AssetList&gt;</code>](#AssetList)
    * [.createAsset(options)](#module_api.Sdk+createAsset) ⇒ [<code>Promise.&lt;AssetResource&gt;</code>](#AssetResource)
    * [.deleteAsset(assetID)](#module_api.Sdk+deleteAsset) ⇒ <code>Promise.&lt;void&gt;</code>
    * [.getAsset(assetID)](#module_api.Sdk+getAsset) ⇒ [<code>Promise.&lt;AssetResource&gt;</code>](#AssetResource)
    * [.createEntry(value)](#module_api.Sdk+createEntry) ⇒ [<code>Promise.&lt;EntryResource&gt;</code>](#EntryResource)
    * [.editEntry(entryID, value)](#module_api.Sdk+editEntry) ⇒ [<code>Promise.&lt;EntryResource&gt;</code>](#EntryResource)
    * [.deleteEntry(entryID)](#module_api.Sdk+deleteEntry) ⇒ <code>void</code>
    * [.model(model)](#module_api.Sdk+model) ⇒
    * [.token(token)](#module_api.Sdk+token) ⇒
    * [.dmShortID(dmShortID)](#module_api.Sdk+dmShortID) ⇒
    * [.dm(dmShortID)](#module_api.Sdk+dm) ⇒
    * [.assetGroup(assetGroup)](#module_api.Sdk+assetGroup) ⇒
    * [.assetgroup(assetGroup)](#module_api.Sdk+assetgroup) ⇒

<a name="module_api.Sdk+entries"></a>

#### sdk.entries([options]) ⇒ [<code>Promise.&lt;EntryList&gt;</code>](#EntryList)
<p>Loads entry list. Expects <code>dmShortID</code> / <code>model</code> to be set.
If the model is not public, you also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type | Description |
| --- | --- | --- |
| [options] | <code>object</code> | <p>options for entry list request.</p> |

**Example**  
```js
// public model
const muffins = await sdk("stage").dm("83cc6374").model("muffin").entries()
```
**Example**  
```js
// non-public model
const secrets = await sdk("stage").token(token).dm("83cc6374").model("secret").entries()
```
<a name="module_api.Sdk+getEntry"></a>

#### sdk.getEntry(entryID) ⇒ [<code>Promise.&lt;EntryResource&gt;</code>](#EntryResource)
<p>Loads a single entry. Expects <code>dmShortID</code> / <code>model</code> to be set.
If the model is not public, you also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type |
| --- | --- |
| entryID | <code>string</code> | 

**Example**  
```js
const muffin = await sdk("stage").dm("83cc6374").model("muffin").getEntry("1gOtzWvrdq")
```
<a name="module_api.Sdk+assets"></a>

#### sdk.assets([options]) ⇒ [<code>Promise.&lt;AssetList&gt;</code>](#AssetList)
<p>Loads asset list. Expects <code>dmShortID</code> / <code>assetGroup</code> to be set.
If the assetGroup is not public, you also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type | Description |
| --- | --- | --- |
| [options] | <code>object</code> | <p>options for entry list request.</p> |

**Example**  
```js
// public assetGroup
const files = await sdk("stage").dm("83cc6374").assetGroup("avatars").assets()
```
**Example**  
```js
// non-public assetGroup
const files = await sdk("stage").token(token).dm("83cc6374").assetGroup("avatars").assets()
```
<a name="module_api.Sdk+createAsset"></a>

#### sdk.createAsset(options) ⇒ [<code>Promise.&lt;AssetResource&gt;</code>](#AssetResource)
<p>Uploads an asset. Expects <code>dmShortID</code> / <code>assetGroup</code> / <code>file</code> to be set.
If the assetGroup is not public, you also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type | Description |
| --- | --- | --- |
| options | <code>Object</code> | <p>options for entry list request.</p> |

**Example**  
```js
// browser example
document.getElementById("file").addEventListener("input", async (e) => {
  const [file] = e.target.files;
  const asset = await ecadmin.assetgroup("test").createAsset({ file })
});
```
**Example**  
```js
// node example
const buf = fs.readFileSync("venndiagram.png");
const file = new Blob([buf]);
const upload = await sdk("stage")
.dm("83cc6374")
.assetgroup("test")
.createAsset({ file, name: "venndiagram.png" });
```
<a name="module_api.Sdk+deleteAsset"></a>

#### sdk.deleteAsset(assetID) ⇒ <code>Promise.&lt;void&gt;</code>
<p>Deletes an asset. Expects <code>dmShortID</code> / <code>assetGroup</code> / <code>assetID</code> to be set.
You probably also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type |
| --- | --- |
| assetID | <code>string</code> | 

**Example**  
```js
await ecadmin.assetgroup("test").deleteAsset('xxxx');
```
<a name="module_api.Sdk+getAsset"></a>

#### sdk.getAsset(assetID) ⇒ [<code>Promise.&lt;AssetResource&gt;</code>](#AssetResource)
<p>Loads a single asset. Expects <code>dmShortID</code> / <code>assetGroup</code> to be set.
If the asset group is not public, you also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type |
| --- | --- |
| assetID | <code>string</code> | 

**Example**  
```js
const asset = await sdk("stage").dm("83cc6374").assetgroup("test").getAsset("tP-ZxpZZTGmbPnET-wArAQ")
```
<a name="module_api.Sdk+createEntry"></a>

#### sdk.createEntry(value) ⇒ [<code>Promise.&lt;EntryResource&gt;</code>](#EntryResource)
<p>Creates a new entry. Expects <code>dmShortID</code> / <code>model</code> to be set.
If model POST is not public, you also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type | Description |
| --- | --- | --- |
| value | <code>object</code> | <p>values to set.</p> |

**Example**  
```js
const entry = await sdk("stage").dm("83cc6374").model("muffin").createEntry({ name: 'test' })
```
<a name="module_api.Sdk+editEntry"></a>

#### sdk.editEntry(entryID, value) ⇒ [<code>Promise.&lt;EntryResource&gt;</code>](#EntryResource)
<p>Edits an entry. Expects <code>dmShortID</code> / <code>model</code> to be set.
If model PUT is not public, you also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type | Description |
| --- | --- | --- |
| entryID | <code>string</code> | <p>id of entry to edit</p> |
| value | <code>object</code> | <p>values to set. undefined fields are ignored</p> |

**Example**  
```js
const entry = await sdk("stage").dm("83cc6374").model("muffin").editEntry("1gOtzWvrdq", { name: "test" })
```
<a name="module_api.Sdk+deleteEntry"></a>

#### sdk.deleteEntry(entryID) ⇒ <code>void</code>
<p>Deletes an entry. Expects <code>dmShortID</code> / <code>model</code> to be set.
If model DELETE is not public, you also need to provide a <code>token</code>.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  

| Param | Type | Description |
| --- | --- | --- |
| entryID | <code>string</code> | <p>id of entry to delete</p> |

**Example**  
```js
await sdk("stage").dm("83cc6374").model("muffin").deleteEntry("1gOtzWvrdq")
```
<a name="module_api.Sdk+model"></a>

#### sdk.model(model) ⇒
<p>Sets the given model to use</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  
**Returns**: <p>Sdk</p>  

| Param | Type | Description |
| --- | --- | --- |
| model | <code>string</code> | <p>name of the model</p> |

<a name="module_api.Sdk+token"></a>

#### sdk.token(token) ⇒
<p>Sets the token to use in requests</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  
**Returns**: <p>Sdk</p>  

| Param | Type |
| --- | --- |
| token | <code>string</code> | 

<a name="module_api.Sdk+dmShortID"></a>

#### sdk.dmShortID(dmShortID) ⇒
<p>Sets the short ID of the datamanager to use</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  
**Returns**: <p>Sdk</p>  

| Param | Type |
| --- | --- |
| dmShortID | <code>string</code> | 

<a name="module_api.Sdk+dm"></a>

#### sdk.dm(dmShortID) ⇒
<p>Sets the short ID of the datamanager to use. Alias for <code>dmShortID</code></p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  
**Returns**: <p>Sdk</p>  

| Param | Type |
| --- | --- |
| dmShortID | <code>string</code> | 

<a name="module_api.Sdk+assetGroup"></a>

#### sdk.assetGroup(assetGroup) ⇒
<p>Sets the name of the asset group to use.</p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  
**Returns**: <p>Sdk</p>  

| Param | Type | Description |
| --- | --- | --- |
| assetGroup | <code>string</code> | <p>name of the asset group</p> |

<a name="module_api.Sdk+assetgroup"></a>

#### sdk.assetgroup(assetGroup) ⇒
<p>Sets the name of the asset group to use. Alias for <code>assetGroup</code></p>

**Kind**: instance method of [<code>Sdk</code>](#module_api.Sdk)  
**Returns**: <p>Sdk</p>  

| Param | Type | Description |
| --- | --- | --- |
| assetGroup | <code>string</code> | <p>name of the asset group</p> |

