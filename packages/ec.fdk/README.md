<div style="width:180px;float:right">
<?xml version="1.0" encoding="UTF-8"?><svg id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600.7"><path d="M422.28,308.6c12.1,.99,24.4,1.93,36.68,3.02,10.25,.91,20.47,2.25,30.73,2.95,8.72,.59,16.86-1.5,23.84-7.14,.67-.54,1.5-.89,3.35-.97-.51,2.22-.35,4.99-1.65,6.54-3.35,3.95-6.84,8.19-11.18,10.83-11.86,7.22-25.26,10.37-38.95,10.76-13.61,.38-27.26-.86-40.9-1.16-9.3-.21-18.61-.04-27.91,.51,67.15,9.38,61.72,8.24,89.33,4-18.08,12.19-36.83,20.92-57.58,26.24,7.5,2.43,11.84,2.44,26.68,.21-.14,3.48-2.65,7.26-7.16,10.55-10.06,7.34-21.67,11.05-33.55,13.95-19.56,4.77-39.52,4.97-59.5,4.64-4.34-.07-8.68-.01-13.08,.5,13.06,5.11,26.62,7.46,40.58,8.25,14.01,.8,27.7-.13,41.35-5.71-1.72,6.11-4.73,10.97-8.58,15.2-13.73,15.11-31.1,23.32-51.16,25.82-8.13,1.01-16.37,1.11-24.88,1.64,7.81,4.66,16.19,6.12,25.16,5.64,9.06-.48,17.1-3.93,24.99-8.02l.69,1.08c-4.32,3.12-8.4,6.64-13,9.28-9.97,5.74-21,8.44-32.39,8.92-11.44,.48-22.92,.09-34.39,.17-4.05,.03-8.08,.36-11.57,2.61-.03,.42-.06,.84-.09,1.26,4.4,1.01,8.74,2.42,13.2,2.96,8.81,1.06,17.69,1.48,26.51,2.5,3.96,.46,8.31,.46,12,5.17-5.69,.88-10.65,1.97-15.66,2.37-15.15,1.2-30.32,2.19-45.48,3.14-7.99,.5-13.88,3.51-18.92,10.37-11.03,15.03-22.99,29.38-34.89,43.74-3.07,3.71-7.19,6.63-11.09,9.54-3.81,2.84-5.58,1.91-5.67-2.8-.17-9.14,1.61-18.03,5.57-26.18,5.77-11.89,12.15-23.49,18.5-35.1,1.53-2.8,1.75-4.72-.21-7.52-11.84-16.89-16.41-35.89-14.88-56.27,.48-6.41,2.51-12.7,3.83-19.05,.53,.04,1.06,.08,1.58,.12,.71,4.18,1.4,8.37,2.15,12.55,2.69,14.92,10.18,25.93,25.16,30.8,.48,.16,.99,.27,1.49,.34,.23,.03,.49-.09,1.03-.21-24.43-41.45-22.83-82.24,2.85-122.39-4.98,30.59-5.84,60.27,16.21,85.4l1.05-.21c-1.74-6.26-3.73-12.47-5.17-18.8-5.96-26.36-3.47-52.1,6.06-77.27,11.48-30.31,28.74-57.12,49.52-81.8,1.07-1.27,2.27-2.43,3.75-3.56-15.63,32.01-20.12,63.68,2.05,94.7-1.17-6.2-2.54-12.38-3.46-18.61-3.12-21.15,.23-41.53,8.08-61.21,10.57-26.48,27.36-48.55,48.77-67.19,13.82-12.03,28.71-22.59,44.54-31.81,.53-.31,1.06-.61,1.9-.52-5.28,4.71-10.58,9.39-15.82,14.14-15.82,14.35-29.43,30.37-36.68,50.83-8.79,24.81-8.11,49.39,3.27,73.45-.24-1.9-.48-3.79-.72-5.69-.25-2.04-.54-4.08-.75-6.12-2.53-24.69,3-47.77,14.1-69.68,15.33-30.27,38.64-52.73,68.11-69.05,7.04-3.9,14.28-7.42,21.72-10.73-11.64,9.33-21.57,19.84-25.93,34.45-4.32,14.5-4.72,28.76,3.9,42.3,.07-.67,.24-1.35,.2-2.01-1.8-31.86,13.48-54.27,39.33-70.67,20.17-12.8,42.33-20.47,65.93-23.39,11.94-1.48,24.14-2.04,36.16-1.57,31.31,1.23,49.5,29.26,38.31,58.8-8.47,22.34-25.75,35.7-47.51,43.79-5.34,1.99-11.07,2.94-17.49,4.59,16.75,6.65,30.66,1.21,44.37-7.67-9.53,14.85-45.53,39.76-73.29,50.86-28.3,11.31-58.02,14.03-88.26,14.97,5.4,1.04,10.75,2.49,16.2,3.03,13.43,1.32,26.89,2.85,40.37,3.14,25.98,.57,48.3-8.57,66.5-27.34,.35-.36,.77-.67,1.15-1.01l.85,.58c-2.92,4.18-5.44,8.71-8.81,12.5-23.65,26.59-51.9,46.08-87.16,53.55-11.25,2.38-23.01,2.34-34.51,3.63-12.37,1.39-24.72,3.03-37.07,4.62-1.05,.14-2.05,.69-2.69,.91Zm145.37-151.72c-1.45,.43-1.79,.5-2.1,.63-1.52,.67-3.05,1.33-4.54,2.05-50.38,24.25-95.21,56.55-136.02,94.54-38.56,35.9-73.82,74.85-105.49,116.98-29.04,38.64-55.18,79.14-77.54,122.02-4.66,8.93-8.62,18.22-12.91,27.34,13.09-14.03,25.94-27.99,36.34-44.09,40.57-62.84,84.8-122.91,135.35-178.21,43.47-47.55,90.87-90.55,144.44-126.52,7.11-4.78,14.32-9.41,22.46-14.74Z"/></svg>
</div>

# ec.fdk

*F*eatherweight *D*evelopment *K*it for entrecode APIs.

[ec.fdk docs](https://entrecode.github.io/ec.fdk)

## Install

```sh
npm i ec.fdk
```

## Getting Started

There are 2 ways to use ec.fdk:

- method chaining
- act

### Method Chaining

Start by calling `fdk` with your environment (`stage` | `live`), then method chain your way to success:

```js
import { fdk } from 'ec.fdk';

fdk('stage') // choose stage environment
  .dm('<shortID>') // select datamanager via short id
  .model('muffin') // select model muffin
  .entryList() // load entry list
  .then((list) => {
    console.log(list);
  });
```

See all functions in the [Fdk reference](https://entrecode.github.io/ec.fdk/classes/Fdk.html).

### act

The act function converts a single object param into a fetch request:

```js
const muffins = await act({
  action: 'entryList',
  env: 'stage',
  dmShortID: '<shortID>',
  model: 'muffin',
});
```

More in the [act reference](https://entrecode.github.io/ec.fdk/functions/act.html).

### Using act with swr / react-query

The act function is good to be used with swr or react-query:

```js
import { act } from 'ec.fdk';
import useSWR from 'swr';

export function useFdk(config) {
  const key = config ? JSON.stringify(config) : null;
  return useSWR([key], () => act(config));
}
```

Then use the hook:

```js
const config = {
  env: 'stage',
  dmShortID: '<shortID>',
};

function App() {
  const { data: entryList } = useFdk({
    ...config,
    action: 'entryList',
    model: 'muffin',
  });
  /* more stuff */
}
```

## CLI

ec.fdk also ships a CLI for quick shell-based interaction with entrecode APIs. Output is JSON, so you can pipe it into `jq` and friends.

### Usage

```sh
npx ec.fdk <command> [options]
```

Or install globally:

```sh
npm i -g ec.fdk
ec.fdk <command> [options]
```

### Commands

#### Entry commands (require `--dm`, `--model`)

| Command       | Description      | Required flags    |
| ------------- | ---------------- | ----------------- |
| `entryList`   | List entries     | `--dm`, `--model` |
| `getEntry`    | Get a single entry | `--dm`, `--model`, `--id` |
| `createEntry` | Create an entry  | `--dm`, `--model`, `--data` |
| `editEntry`   | Edit an entry    | `--dm`, `--model`, `--id`, `--data` |
| `deleteEntry` | Delete an entry  | `--dm`, `--model`, `--id` |
| `getSchema`   | Get model schema | `--dm`, `--model` |

#### Datamanager (`--id` = DM UUID)

| Command             | Description          | Required flags |
| ------------------- | -------------------- | -------------- |
| `dmList`            | List datamanagers    | — |
| `getDatamanager`    | Get a datamanager    | `--id` |
| `createDatamanager` | Create a datamanager | `--data` |
| `editDatamanager`   | Edit a datamanager (full PUT) | `--id`, `--data` |
| `deleteDatamanager` | Delete a datamanager | `--id` |
| `getStats`          | Get datamanager stats | — |

#### Model (`--id` = DM UUID)

| Command       | Description    | Required flags |
| ------------- | -------------- | -------------- |
| `modelList`   | List models    | `--id` |
| `createModel` | Create a model | `--id`, `--data` |
| `editModel`   | Edit a model   | `--id`, `--rid`, `--data` |
| `deleteModel` | Delete a model | `--id`, `--rid` |

#### Template

| Command          | Description       | Required flags |
| ---------------- | ----------------- | -------------- |
| `createTemplate` | Create a template | `--data` |

#### Asset Group (`--id` = DM UUID)

| Command            | Description           | Required flags |
| ------------------ | --------------------- | -------------- |
| `createAssetGroup` | Create an asset group | `--id`, `--data` |
| `editAssetGroup`   | Edit an asset group   | `--id`, `--rid`, `--data` |

#### Assets (`--dm` = short ID)

| Command       | Description                    | Required flags |
| ------------- | ------------------------------ | -------------- |
| `assetList`   | List assets                    | `--dm`, `--assetgroup` |
| `getAsset`    | Get a single asset             | `--dm`, `--assetgroup`, `--rid` |
| `createAsset` | Upload asset(s) from local file | `--dm`, `--assetgroup`, `--file` (repeatable) |
| `editAsset`   | Edit asset metadata            | `--dm`, `--assetgroup`, `--rid`, `--data` |
| `deleteAsset` | Delete an asset                | `--dm`, `--assetgroup`, `--rid` |

#### DM Client (`--id` = DM UUID)

| Command        | Description      | Required flags |
| -------------- | ---------------- | -------------- |
| `editDmClient` | Edit a DM client | `--id`, `--rid`, `--data` |

#### Role (`--id` = DM UUID)

| Command      | Description   | Required flags |
| ------------ | ------------- | -------------- |
| `createRole` | Create a role | `--id`, `--data` |
| `editRole`   | Edit a role   | `--id`, `--rid`, `--data` |
| `deleteRole` | Delete a role | `--id`, `--rid` |

#### DM Account (`--id` = DM UUID)

| Command           | Description        | Required flags |
| ----------------- | ------------------ | -------------- |
| `editDmAccount`   | Edit a DM account  | `--id`, `--account-id`, `--data` |
| `deleteDmAccount` | Delete a DM account | `--id`, `--account-id` |

#### Account Client

| Command               | Description             | Required flags |
| --------------------- | ----------------------- | -------------- |
| `createAccountClient` | Create an account client | `--data` |
| `editAccountClient`   | Edit an account client  | `--rid`, `--data` |
| `deleteAccountClient` | Delete an account client | `--rid` |

#### Group

| Command       | Description    | Required flags |
| ------------- | -------------- | -------------- |
| `createGroup` | Create a group | `--data` |
| `editGroup`   | Edit a group   | `--rid`, `--data` |
| `deleteGroup` | Delete a group | `--rid` |

#### Invite

| Command        | Description     | Required flags |
| -------------- | --------------- | -------------- |
| `createInvite` | Create an invite | `--data` |
| `editInvite`   | Edit an invite  | `--rid`, `--data` |
| `deleteInvite` | Delete an invite | `--rid` |

#### Account

| Command       | Description    | Required flags |
| ------------- | -------------- | -------------- |
| `editAccount` | Edit an account | `--account-id`, `--data` |

#### Tokens

| Command       | Description    | Required flags |
| ------------- | -------------- | -------------- |
| `listTokens`  | List tokens    | `--account-id` |
| `createToken` | Create a token | `--account-id` |
| `deleteToken` | Delete a token | `--account-id`, `--rid` |

#### Other

| Command        | Description               | Required flags |
| -------------- | ------------------------- | -------------- |
| `login`          | Login via browser (OIDC). Use `--password` for email/password prompt. | — |
| `logout`         | Logout and remove stored token | — |
| `whoami`         | Show current logged-in user | — |
| `install-skill`  | Install Claude Code skill | — (optional `--dir <path>`) |
| `update`         | Self-update ec.fdk        | — |
| `resourceList`   | List any resource type    | `--resource`, `-f` for query params |
| `resourceGet`    | Get a single resource     | `--resource`, `-f` for identifying params |
| `resourceEdit`   | Edit a single resource    | `--resource`, `-f` for identifying params, `--data` |
| `resourceDelete` | Delete a single resource  | `--resource`, `-f` for identifying params |
| `describe`       | Show type definition for a command's return value | `<command>` |
| `typegen`        | Generate typed entry APIs (.d.ts) for a datamanager | `--dm` (optional `--out <path>`) |
| `getHistory`     | Get dm-history entries    | `-f shortID=<shortID>` |

##### `resourceList` resource types

| `--resource` | `--subdomain` | Typical filters |
| --- | --- | --- |
| `model` | — | `-f dataManagerID=<dataManagerID>` |
| `assetgroup` | — | `-f dataManagerID=<dataManagerID>` |
| `client` | — | `-f dataManagerID=<dataManagerID>` |
| `role` | — | `-f dataManagerID=<dataManagerID>` |
| `account` | — | `-f dataManagerID=<dataManagerID>` |
| `template` | — | — |
| `tag` | — | `-f dataManagerID=<dataManagerID>` |
| `account` | `accounts` | — |
| `client` | `accounts` | — |
| `group` | `accounts` | — |
| `invite` | `accounts` | — |
| `account/tokens` | `accounts` | `-f accountID=<accountID>` |

### Options

| Option                  | Description                                       |
| ----------------------- | ------------------------------------------------- |
| `-e, --env <env>`       | Environment: `stage` \| `live` (default: `stage`) |
| `-d, --dm <shortID>`    | DataManager short ID                              |
| `-m, --model <name>`    | Model name                                        |
| `-i, --id <id>`         | Entry ID or DataManager UUID (context-dependent)  |
| `--rid <id>`            | Resource ID (model, template, role, client, asset group, invite, etc.) |
| `--account-id <id>`     | Account ID                                        |
| `--assetgroup <name>`   | Asset group name (for asset commands)             |
| `--file <path>`         | Local file path for `createAsset` (repeatable)    |
| `--resource <name>`     | Resource name (for `resource*` commands)           |
| `--subdomain <name>`    | Subdomain override (for `resource*` commands)      |
| `--data <json>`         | JSON data (for create/edit, or pipe via stdin)    |
| `-s, --size <n>`        | Page size for list                                |
| `-p, --page <n>`        | Page number for list                              |
| `--sort <field>`        | Sort field for list                               |
| `-f, --filter <k=v>`    | Filter for list (repeatable)                     |
| `--password`            | Use email/password login instead of browser OIDC  |
| `--dir <path>`          | Target directory for `install-skill` (default: `~/.claude`) |
| `--raw`                 | Include `_links` and `_embedded` in output        |
| `--md`                  | Output entries as readable markdown table          |
| `--short`               | Only print the return type, omit referenced types (for `describe`) |
| `--out <path>`          | Output file path for `typegen` (default: `./ec.fdk.d.ts`) |
| `-v, --version`         | Show version                                      |
| `-h, --help`            | Show help                                         |

### Placeholders

All examples use `<PLACEHOLDER>` values — replace them with your own resource IDs.

| Placeholder | Flag | Resource |
| --- | --- | --- |
| `<shortID>` | `--dm` | [Datamanager](https://doc.entrecode.de/datamanager/resources/datamanager/) |
| `<dataManagerID>` | `--id` | [Datamanager](https://doc.entrecode.de/datamanager/resources/datamanager/) |
| `<entryID>` | `--id` | [Model](https://doc.entrecode.de/datamanager/resources/model/) |
| `<modelID>` | `--rid` | [Model](https://doc.entrecode.de/datamanager/resources/model/) |
| `<assetGroup>` | `--rid` / `--assetgroup` | [Asset Group](https://doc.entrecode.de/datamanager/resources/dm-assetgroup/) |
| `<assetID>` | `--rid` | [Asset](https://doc.entrecode.de/datamanager/resources/asset/) |
| `<clientID>` | `--rid` | [DM Client](https://doc.entrecode.de/datamanager/resources/dm-client/) / [Account Client](https://doc.entrecode.de/account/resources/client/) |
| `<roleID>` | `--rid` | [Role](https://doc.entrecode.de/datamanager/resources/dm-role/) |
| `<accountID>` | `--account-id` | [DM Account](https://doc.entrecode.de/datamanager/resources/dm-account/) / [Account](https://doc.entrecode.de/account/resources/account/) |
| `<groupID>` | `--rid` | [Group](https://doc.entrecode.de/account/resources/group/) |
| `<inviteID>` | `--rid` | [Invite](https://doc.entrecode.de/account/resources/invite/) |
| `<tokenID>` | `--rid` | [Token](https://doc.entrecode.de/account/resources/token/) |
| `<collectionID>` | `--data` | [Template](https://doc.entrecode.de/datamanager/resources/dm-template/) |

### Examples

```sh
# Login to stage via browser OIDC (stores token in ~/.ec-fdk/auth.json)
ec.fdk login -e stage

# Login via email/password prompt
ec.fdk login -e stage --password

# Logout
ec.fdk logout -e stage

# Show current user
ec.fdk whoami -e stage

# Install Claude Code skill (to ~/.claude/skills/ec-fdk/)
ec.fdk install-skill

# Install to custom directory
ec.fdk install-skill --dir ~/entrecode/.claude

# Self-update ec.fdk
ec.fdk update

# List datamanagers
ec.fdk dmList -e stage

# Get a single datamanager
ec.fdk getDatamanager -e stage --id <dataManagerID>

# List models of a datamanager
ec.fdk modelList -e stage --id <dataManagerID>

# Filter models by title
ec.fdk modelList --id <dataManagerID> -f title~=muffin

# List entries
ec.fdk entryList -d <shortID> -m muffin

# List with pagination
ec.fdk entryList -d <shortID> -m muffin -s 10 -p 2

# Get a single entry
ec.fdk getEntry -d <shortID> -m muffin -i <entryID>

# Create an entry
ec.fdk createEntry -d <shortID> -m muffin --data '{"name":"new muffin","amazement_factor":10}'

# Create via stdin pipe
echo '{"name":"piped muffin","amazement_factor":10}' | ec.fdk createEntry -d <shortID> -m muffin

# Edit an entry
ec.fdk editEntry -d <shortID> -m muffin -i <entryID> --data '{"name":"edited"}'

# Delete an entry
ec.fdk deleteEntry -d <shortID> -m muffin -i <entryID>

# Get model schema
ec.fdk getSchema -d <shortID> -m muffin

# Filter entries (repeatable -f for arbitrary query params)
ec.fdk entryList -d <shortID> -m muffin -f name~=chocolate
ec.fdk entryList -d <shortID> -m muffin -f amazement_factorFrom=5 -f amazement_factorTo=10
ec.fdk entryList -d <shortID> -m muffin -f createdFrom=2024-01-01

# Filter datamanagers
ec.fdk dmList -f title~=myproject

# Pipe into jq
ec.fdk entryList -d <shortID> -m muffin | jq '.items | length'
```

### Admin examples

```sh
# Datamanager stats
ec.fdk getStats

# dm-history (requires shortID filter)
ec.fdk getHistory -f shortID=<shortID> -s 10

# List any resource type
ec.fdk resourceList --resource template -s 5
ec.fdk resourceList --resource client --subdomain accounts

# Generic get / edit / delete (works with any resource type)
ec.fdk resourceGet --resource model -f dataManagerID=<dataManagerID> -f modelID=<modelID>
ec.fdk resourceGet --resource group --subdomain accounts -f groupID=<groupID>
ec.fdk resourceEdit --resource invite --subdomain accounts -f invite=<inviteID> --data '{"email":"user@example.com","permissions":["dm-read"],"groups":[]}'
ec.fdk resourceDelete --resource role -f dataManagerID=<dataManagerID> -f roleID=<roleID>

# Datamanager
ec.fdk createDatamanager --data '{"title":"My DM","config":{}}'
ec.fdk deleteDatamanager --id <dataManagerID>

# editDatamanager is a full PUT — pass the complete resource, not just changed fields.
# Use getDatamanager + jq to build the payload:
ec.fdk getDatamanager --id <dataManagerID> \
  | jq '.title = "New Title"' \
  | ec.fdk editDatamanager --id <dataManagerID>

# Model
ec.fdk createModel --id <dataManagerID> --data '{"title":"article","locales":[],"fields":[]}'
ec.fdk editModel --id <dataManagerID> --rid <modelID> --data '{"title":"renamed","locales":[],"fields":[]}'
ec.fdk deleteModel --id <dataManagerID> --rid <modelID>

# Template
ec.fdk createTemplate --data '{"name":"My Template","collection":{"id":"<collectionID>","name":"my-collection","order":[],"requests":[]}}'

# Asset group
ec.fdk createAssetGroup --id <dataManagerID> --data '{"assetGroupID":"photos"}'
ec.fdk editAssetGroup --id <dataManagerID> --rid <assetGroup> --data '{"public":true}'

# Assets
ec.fdk assetList --dm <shortID> --assetgroup <assetGroup>
ec.fdk getAsset --dm <shortID> --assetgroup <assetGroup> --rid <assetID>
ec.fdk createAsset --dm <shortID> --assetgroup <assetGroup> --file ./photo.jpg
ec.fdk createAsset --dm <shortID> --assetgroup <assetGroup> --file ./a.jpg --file ./b.png
ec.fdk editAsset --dm <shortID> --assetgroup <assetGroup> --rid <assetID> --data '{"title":"sunset"}'
ec.fdk deleteAsset --dm <shortID> --assetgroup <assetGroup> --rid <assetID>

# DM client
ec.fdk editDmClient --id <dataManagerID> --rid <clientID> --data '{"callbackURL":"https://example.com/cb"}'

# Role
ec.fdk createRole --id <dataManagerID> --data '{"name":"editor"}'
ec.fdk editRole --id <dataManagerID> --rid <roleID> --data '{"name":"admin"}'
ec.fdk deleteRole --id <dataManagerID> --rid <roleID>

# DM account
ec.fdk editDmAccount --id <dataManagerID> --account-id <accountID> --data '{"email":"user@example.com"}'
ec.fdk deleteDmAccount --id <dataManagerID> --account-id <accountID>

# Account client
ec.fdk createAccountClient --data '{"clientID":"my-client","callbackURL":"https://example.com/cb"}'
# editAccountClient is a full PUT — clientID is required in the body.
ec.fdk resourceList --resource client --subdomain accounts -f clientID=my-client \
  | jq '.items[0]' \
  | jq '.callbackURL = "https://example.com/cb2"' \
  | ec.fdk editAccountClient --rid my-client
ec.fdk deleteAccountClient --rid <clientID>

# Group
ec.fdk createGroup --data '{"name":"devs"}'
ec.fdk editGroup --rid <groupID> --data '{"name":"developers"}'
ec.fdk deleteGroup --rid <groupID>

# Invite
ec.fdk createInvite --data '{"email":"user@example.com"}'
# editInvite is a full PUT — pass the complete resource (email, permissions, groups).
ec.fdk editInvite --rid <inviteID> --data '{"email":"user@example.com","permissions":["dm-read"],"groups":[]}'
ec.fdk deleteInvite --rid <inviteID>

# Account
ec.fdk editAccount --account-id <accountID> --data '{"email":"user@example.com"}'

# Tokens
ec.fdk listTokens --account-id <accountID>
ec.fdk createToken --account-id <accountID>
ec.fdk deleteToken --account-id <accountID> --rid <tokenID>
```

### Typegen — Typed Entry APIs

Generate a `.d.ts` declaration file that gives you type-safe entry APIs with autocomplete for all models in a datamanager:

```sh
# Requires login first
ec.fdk login -e stage

# Generate types
ec.fdk typegen --dm <shortID> --env stage --out ./ec.fdk.d.ts
```

Place the generated file in your TypeScript project. After that, `model()` carries the model name as a type parameter, so all entry methods return typed results:

```ts
import { fdk } from 'ec.fdk';

const muffin = await fdk('stage').dm('<shortID>').model('muffin').getEntry('abc');
muffin.name;           // string — autocomplete works
muffin.amazement_factor; // number
muffin.bogus;          // type error

await fdk('stage').dm('<shortID>').model('muffin').createEntry({
  name: 'Blueberry',       // required string
  amazement_factor: 9,     // required number
  color: 'blue',           // required string
});

await fdk('stage').dm('<shortID>').model('muffin').editEntry('abc', {
  name: 'Updated',         // partial — only changed fields needed
});
```

Without a generated file, everything falls back to the default `EntryResource` type with `[key: string]: unknown` — fully backwards-compatible.

| Option | Description |
| ------ | ----------- |
| `--dm <shortID>` | DataManager short ID (required) |
| `--env <env>` | `stage` (default) or `live` |
| `--out <path>` | Output file path (default: `./ec.fdk.d.ts`) |

### Describe

Show the return type of any command:

```sh
# Show the type definition for a command's return value (includes referenced types)
ec.fdk describe getAsset
ec.fdk describe entryList

# Only print the main return type, omit referenced types
ec.fdk describe getAsset --short

# List all describable commands
ec.fdk describe
```

For entry commands (`getEntry`, `entryList`, `createEntry`, `editEntry`), pass `--dm` and `--model` to generate a concrete type with actual field names and types fetched from the model schema (public API, no auth required):

```sh
ec.fdk describe getEntry --dm 83cc6374 --model muffin
# type MuffinEntry = EntryResourceBase & {
#     name: string;
#     amazement_factor: number;
#     test_asset: string | null;
#     color: string;
# }
#
# type EntryResourceBase = {
#     id: string;
#     _created: Date;
#     ...
# }

ec.fdk describe entryList --dm 83cc6374 --model muffin
# type EntryList = {
#     count: number;
#     total: number;
#     items: MuffinEntry[];
# }
# ...
```

Without `--dm`/`--model`, the generic `EntryResource` type with `[key: string]: any` is shown.

The `-f` flag maps directly to [entrecode filter query params](https://doc.entrecode.de/api-basics/#filtering). Common filter suffixes:

| Suffix     | Meaning              | Example                        |
| ---------- | -------------------- | ------------------------------ |
| `~`        | Search (contains)    | `-f name~=chocolate`           |
| `From`     | Greater than / after | `-f createdFrom=2024-01-01`    |
| `To`       | Less than / before   | `-f createdTo=2025-01-01`      |
| (none)     | Exact match          | `-f amazement_factor=10`       |

Status/error messages go to stderr, data goes to stdout — so piping always works cleanly.

## migration from ec.sdk

ec.fdk won't change / decorate data returned from ec APIs. For example, an entry returned from the datamanager will be returned as is.
Advantages:

- The network tab shows what goes into the frontend
- Resources have the same shape everywhere
- Resources are serializable

### Entry save

Instead of mutating an EntryResource and calling `.save()`, we now pass the new `value` directly:

```js
// this does not exist anymore:
await entry.save(); // <- DONT
// use this to update an entry:
await editEntryObject(entry, value); // <- DO
// alternatively:
await fdk.env(env).dm(dmShortID).model(model).updateEntry(entryID, value);
// or:
await act({ action: 'editEntry', env, dmShortID, model, entryID, value });
```

### Entry delete

Similar to save:

```js
// this does not exist anymore:
await entry.del(); // <- DONT
// use this to delete an entry:
await deleteEntryObject(entry); // <- DO
// alternatively:
await fdk.dm('shortID').model('model').deleteEntry('entryID');
// or:
await act({ action: 'deleteEntry', env, dmShortID, model, entryID });
```

### Entry Asset Fields

In ec.fdk, entry asset fields are plain ids:

```js
// assuming "photo" is an asset field:
entry.photo; // <-- this used to be an AssetResource. Now it's a plain id string.
// use this to get the embedded AssetResource:
getEntryAsset('photo', entry); // (no request goes out)
```

### Entry Date Fields

```js
// assuming "lastSeen" is a datetime field:
entry.lastSeen; // <-- this used to be an instance of Date. Now it's a date ISO string
// use this to get a Date instance:
new Date(entry.lastSeen);
```

### Entry List

```js
// ec.sdk
const api = new PublicAPI(shortID, env, true);
const entryList = await api.entryList(model);
const items = entryList.getAllItems();
const first = entryList.getFirstItem();
// ec.fdk
const api = fdk(env).dm(shortID);
const entryList = await api.entryList(model);
const items = entryList.items; // <------- change
const first = entryList.items[0]; // <------- change
// or in one line:
const entryList = await fdk(env).dm(shortID).entryList(model);
```

### Entry List Filter Options

By default, the second param of ec.fdk `entryList` will just convert the object to url params:

```js
const entryList = await fdk('stage').dm('<shortID>').entryList({ createdTo: '2021-01-18T09:13:47.605Z' });
/* 
https://datamanager.cachena.entrecode.de/api/<shortID>/muffin?
_list=true&
createdTo=2021-01-18T09:13:47.605Z&
page=1&
size=50
*/
```

Read more in the [entrecode filtering doc](https://doc.entrecode.de/api-basics/#filtering)

There is some syntax sugar you can use to get the same behavior as [ec.sdk filterOptions](https://entrecode.github.io/ec.sdk/#filteroptions):

```js
const entryList = await fdk('stage')
  .dm('<shortID>')
  .entryList(filterOptions({ created: { to: '2021-01-18T09:13:47.605Z' } }));
```

### Asset List

```js
// ec.sdk
await api.dmAssetList(group, { assetID: { any: value } });
// ec.fdk
const options = sdkOptions({ assetID: { any: value } } as any);
const assets = await api.assetGroup(group).assetList(options);
```

### Load Asset

```js
// ec.sdk
api.dmAsset(group, img);
// ec.fdk
api.assetGroup(group).getAsset(img);
```

## Publish

```sh
cd packages/ec.fdk
./publish.sh
```

The script prompts for a new version, regenerates docs, commits, pushes, and publishes to npm.
